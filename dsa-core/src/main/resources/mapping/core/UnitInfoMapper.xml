<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dsa.core.dao.UnitInfoDao">
    <!-- 管理单元树 运维班管理单元 -->
    <select id="findUnitInfoList" resultType="com.dsa.utils.node.Node">
 SELECT * FROM
        (
            SELECT
                a.OrgID id,
                a.ParentOrgID pid,
                a.vc_Name title,
                "0" isOrg,
                a.i_Sort iSort
            FROM
                m_orginfo a UNION ALL
            SELECT
                b.UnitID id,
                b.OrgID pid,
                b.vc_Name title,
                "1" isOrg,
                b.i_Sort iSort
            FROM
                m_unitinfo b INNER JOIN m_cstation c ON b.UnitID = c.UnitID
								WHERE b.i_Type = 2
        ) s
      ORDER BY s.iSort, s.title
    </select>

<insert id="insertUnitInfo">
    INSERT INTO m_unitinfo ( UnitID, OrgID, vc_Name, i_Type, i_VoltageLevelID, i_Sort, i_IsEnable, i_Flag, vc_Memo )
    VALUES
	(#{unitId},#{orgId},#{vcName},#{iType},#{iVoltageLevelId},#{iSort},#{iIsEnable},#{iFlag},#{vcMemo})
</insert>
    <update id="updateUnitInfo">
        UPDATE m_unitinfo SET
        <trim suffixOverrides=",">
            <if test="orgId != null">
                OrgID = #{orgId},
            </if>
            <if test="orgId != null">
                vc_Name = #{vcName},
            </if>
            <if test="orgId != null">
                i_Type = #{iType},
            </if>
            <if test="orgId != null">
                i_VoltageLevelID = #{iVoltageLevelId},
            </if>
            <if test="orgId != null">
                i_Sort = #{iSort},
            </if>
            <if test="orgId != null">
                i_IsEnable = #{iIsEnable},
            </if>
            <if test="orgId != null">
                i_Flag = #{iFlag},
            </if>
            <if test="orgId != null">
                vc_Memo = #{vcMemo},
            </if>
        </trim>
        WHERE UnitID = #{unitId}
    </update>

    <delete id="delUnitInfo">
        DELETE FROM  m_unitinfo WHERE UnitID IN
        <foreach collection="unitInfoList" index="index" item="item" close=")" open="(" separator=",">
            #{item.unitId}
        </foreach>
    </delete>
</mapper>