<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dsa.core.dao.StationDao">

    <select id="findStationList" resultType="com.dsa.core.dto.StationOutputDto">
        SELECT
            a.UnitID unitId,
            a.vc_ProjectCompany vcProjectCompany,
            a.i_AccessTime iAccessTime,
            a.i_RunTime iRunTime,
            a.vc_Address vcAddress,
            a.d_Mapx dMapx,
            a.d_Mapy dMapy,
            a.i_Sort iSort,
            a.i_Status iStatus,
            a.i_Param1 iParam1,
            a.i_Param2 iParam2,
            a.i_Param3 iParam3,
            a.vc_Param1 vcParam1,
            a.vc_Param2 vcParam2,
            a.vc_Param3 vcParam3,
            a.i_Flag iFlag,
            a.vc_Memo vcMemo,
            b.vc_Name vcName,
            c.vc_Name OrgName,
            b.i_VoltageLevelID iVoltageLevelId,
            b.i_IsEnable iIsEnable
        FROM
            m_cstation a
            INNER JOIN m_unitinfo b ON a.UnitID = b.UnitID
            LEFT JOIN m_orginfo c ON b.OrgID = c.OrgID
        WHERE 1 = 1 AND b.i_Type = 2
        <if test="orgId != null and orgId != ''">
            AND FIND_IN_SET(c.OrgID, GETORGIDLIST(#{orgId}))
        </if>
        <if test="vcName != null and vcName != ''">
            AND b.vc_Name LIKE "%${vcName}%"
        </if>
        <if test="iVoltageLevelId != null and iVoltageLevelId != ''">
            AND b.i_VoltageLevelID = #{iVoltageLevelId}
        </if>
        <if test="unitId != null and unitId != ''">
            AND a.UnitID = #{unitId}
        </if>

    </select>

    <insert id="insertStation">
        INSERT INTO m_cstation (UnitID,vc_ProjectCompany,i_AccessTime,i_RunTime,vc_Address,d_Mapx,d_Mapy,i_Sort,i_Param1,i_Param2,i_Param3,vc_Param1,vc_Param2,vc_Param3,i_Flag,vc_Memo) VALUES
        (#{unitId},#{vcProjectCompany},#{iAccessTime},#{iRunTime},#{vcAddress},#{dMapx},#{dMapy},#{iSort},#{iParam1},#{iParam2},#{iParam3},#{vcParam1},#{vcParam2},#{vcParam3},#{iFlag},#{vcMemo})
    </insert>

    <update id="updateStation">
        UPDATE m_cstation SET
        <trim suffixOverrides=",">
            <if test="vcProjectCompany !=null">
                vc_ProjectCompany = #{vcProjectCompany},
            </if>
            <if test="iAccessTime !=null">
                i_AccessTime = #{iAccessTime},
            </if>
            <if test="iRunTime !=null">
                i_RunTime = #{iRunTime},
            </if>
            <if test="vcAddress !=null">
                vc_Address = #{vcAddress},
            </if>
            <if test="dMapx !=null">
                d_Mapx = #{dMapx},
            </if>
            <if test="dMapy !=null">
                d_Mapy = #{dMapy},
            </if>
            <if test="iSort !=null">
                i_Sort = #{iSort},
            </if>
            <if test="iStatus !=null">
                i_Status = #{iStatus},
            </if>
            <if test="iParam1 !=null">
                i_Param1 = #{iParam1},
            </if>
            <if test="iParam2 !=null">
                i_Param2 = #{iParam2},
            </if>
            <if test="iParam3 !=null">
                i_Param3 = #{iParam3},
            </if>
            <if test="vcParam1 !=null">
                vc_Param1 = #{vcParam1},
            </if>
            <if test="vcParam2 !=null">
                vc_Param2 = #{vcParam2},
            </if>
            <if test="vcParam3 !=null">
                vc_Param3 = #{vcParam3},
            </if>
            <if test="iFlag !=null">
                i_Flag = #{iFlag},
            </if>
            <if test="vcMemo !=null">
                vc_Memo = #{vcMemo},
            </if>
        </trim>
        WHERE UnitID = #{unitId}
    </update>

    <delete id="delStation">
        DELETE FROM m_cstation WHERE UnitID IN
        <foreach collection="stationList" index="index" item="item" close=")" open="(" separator=",">
            #{item.unitId}
        </foreach>

    </delete>

</mapper>